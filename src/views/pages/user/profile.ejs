<%- include('../../components/head', { page: {title: 'Профиль'} }) %>
<%- include('../../components/navbar') %>

<main class="bg-slate-50">
    <section class="container mx-auto max-w-4xl px-4 py-12 space-y-8">
        <div class="rounded-2xl border border-slate-200 bg-white p-8 shadow-sm flex flex-col gap-6 md:flex-row md:items-center md:justify-between">
            <div class="flex items-center gap-4">
                <div class="flex h-14 w-14 items-center justify-center rounded-full bg-slate-900 text-xl font-semibold text-white"><%= profile.user.username.slice(0,2).toUpperCase() %></div>
                <div>
                    <p class="text-sm text-slate-500">Профиль пользователя</p>
                    <h1 class="text-2xl font-bold text-slate-900"><%= profile.user.username %></h1>
                    <p class="text-sm text-slate-600"><%= profile.user.email %></p>
                </div>
            </div>
            <div class="flex flex-wrap items-center gap-3">
                <% profile.user.roles.forEach(function(role) { %>
                    <span class="rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-900"><%= role.name %></span>
                <% }) %>
            </div>
        </div>

        <div class="rounded-2xl border border-slate-200 bg-white p-8 shadow-sm space-y-4">
            <h2 class="text-lg font-semibold text-slate-900">Действия</h2>
            <div class="flex flex-wrap gap-3">
                <% if(user && user.id === profile.user.id) { %>
                    <form action="/auth/logout" method="post">
                        <button type="submit" class="rounded-lg border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-100 cursor-pointer">Выйти</button>
                    </form>
                <% } %>
                <% if(user && user.id !== profile.user.id && isAdmin) { %>
                    <form action="/user/remove/<%= profile.user.id %>" method="post">
                        <button type="submit" class="rounded-lg border border-red-200 px-4 py-2 text-sm font-semibold text-red-700 hover:bg-red-50 cursor-pointer">Удалить пользователя</button>
                    </form>
                    <a href="/user/edit/<%= profile.user.username %>" class="rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800">Редактировать</a>
                <% } %>
            </div>
        </div>
    </section>
</main>

<%- include('../../components/footer') %>
